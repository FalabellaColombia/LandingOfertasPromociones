(()=>{document.addEventListener("DOMContentLoaded",async()=>{let s="../scripts/data.json",v={mobile:18,desktop:12},f=document.querySelector(".nav"),S=document.querySelector(".seo"),y=document.querySelector(".skeleton-container"),h=document.querySelector(".categorias-container"),L=document.querySelector("#template"),t=new Map,p=()=>{let o=document.createElement("div");return o.className="skeleton",o.innerHTML=`
         <div class="skeleton-image"></div>
         <div class="skeleton-text"></div>
      `,o},i=()=>{let n=window.innerWidth<=768?v.mobile:v.desktop;y.innerHTML="";for(let c=0;c<n;c++)y.appendChild(p())},g=o=>{let n=/(\d+%|ofertas|\$\d{1,3}(\.\d{3})*(,\d+)?|\d+\s*(ml|ML)|ENVÍO\sGRATIS)/gi;return o.replace(n,c=>`<span class="categorias-span" style="font-weight: bold; color: red;">${c}</span>`)},k=(o,n,c)=>{let T=()=>{let e=new Date,a=new Date(o)-e;if(a<=0)return n.innerHTML="OFERTA EXPIRADA",n.style.backgroundColor="#666",n.style.color="white",c.style.border="3px solid #666",!1;let d=Math.floor(a/(1e3*60*60)),u=Math.floor(a%(1e3*60*60)/(1e3*60)),C=Math.floor(a%(1e3*60)/1e3),m=`${d.toString().padStart(2,"0")}:${u.toString().padStart(2,"0")}:${C.toString().padStart(2,"0")}`;return n.innerHTML=`SOLO X ${m}`,!0};return T()?setInterval(()=>{if(!T()){let e=t.get(n);e&&(clearInterval(e),t.delete(n))}},1e3):null},q=(o,n=null)=>{let c=o?.toUpperCase();if(/SOLO X \d+ HORAS/i.test(o)){let r=new Date,a=new Date(n);return r>a?{borderColor:"#666",backgroundColor:"#666",textColor:"white",displayText:"OFERTA EXPIRADA",borderWidth:"3px",hasCountdown:!1}:{borderColor:"red",backgroundColor:"red",textColor:"white",displayText:"",borderWidth:"3px",hasCountdown:!0}}return{AGOTADO:{borderColor:"red",backgroundColor:"red",textColor:"white",displayText:"AGOTADO",borderWidth:"3px",hasCountdown:!1},LANZAMIENTO:{borderColor:"#aad500",backgroundColor:"#aad500",textColor:"black",displayText:"LANZAMIENTO",borderWidth:"3px",hasCountdown:!1}}[c]||{borderColor:"#dfdfdf",backgroundColor:"transparent",textColor:"black",displayText:"",borderWidth:"1px",hasCountdown:!1}},_=o=>{t.forEach(e=>clearInterval(e)),t.clear(),h.innerHTML="";let n=document.createDocumentFragment();if(o.some(e=>/SOLO X \d+ HORAS/i.test(e.offerState))&&!document.querySelector('[data-category-name="SoloX"]')){let e=document.createElement("a");e.href="#SoloX",e.className="nav-item",e.dataset.categoryName="SoloX",e.textContent="Solo X Horas";let r=f.querySelector(".nav-item");f.insertBefore(e,r.nextSibling)}o.filter(e=>{let r=new Date(e.startDate),a=new Date(e.endDate),d=new Date,u=!e.isProductHidden,C=d>=r&&d<=a;return u&&C}).sort((e,r)=>e.orderSellout-r.orderSellout).forEach(e=>{let r=q(e.offerState,e.endDate),a=L.content.cloneNode(!0),d=a.querySelector(".template__link"),u=a.querySelector(".template__image"),C=a.querySelector(".template__title"),m=a.querySelector(".template__tag");d.href=e.urlProduct,d.dataset.title=e.title;let P=/SOLO X \d+ HORAS/i.test(e.offerState);if(d.dataset.category=P?`${e.category} SoloX`:e.category,u.src=e.urlImage,u.alt=e.title||"Product Image",u.style.border=`${r.borderWidth} solid ${r.borderColor}`,C.innerHTML=g(e.title||""),r.displayText||r.hasCountdown)if(m.style.backgroundColor=r.backgroundColor,m.style.color=r.textColor,r.hasCountdown){let E=k(e.endDate,m,u);E&&t.set(m,E)}else m.innerHTML=r.displayText;else m.remove();n.appendChild(a)}),h.appendChild(n),setTimeout(()=>{h.classList.add("categorias-container--show"),f.style.transition="opacity 0.5s ease-in-out",f.classList.add("nav--visible"),S.classList.add("seo--visible"),document.dispatchEvent(new Event("navLoaded"))},100)},I=async()=>{try{i();let n=await(await fetch(s)).json();if(!Array.isArray(n)){console.error("Estructura de datos de productos inv\xE1lida:",n);return}y.style.display="none",_(n)}catch(o){console.error("Error al cargar el cat\xE1logo de productos:",o)}};window.addEventListener("beforeunload",()=>{t.forEach(o=>clearInterval(o))}),await I()});document.addEventListener("navLoaded",()=>{let s=document.querySelector(".nav"),l=document.querySelectorAll(".nav-item"),v=document.querySelectorAll(".template__link"),f=document.querySelector(".banner"),S=document.querySelector('[data-category-name="VerTodo"]'),y=()=>{v.forEach(t=>{t.style.display="block"})};function h(){let t=document.querySelector('[data-category-name="VerTodo"]');t&&t.click()}let L=t=>{let p=0;if(v.forEach(i=>{(i.getAttribute("data-category")||"").split(" ").includes(t)?(i.style.display="block",p++):i.style.display="none"}),p===0){let i=document.querySelector(".empty-state"),g=document.querySelector(".empty-state__btn");i.style.display="block",g.addEventListener("click",h)}else{let i=document.querySelector(".empty-state");i.style.display="none"}};y(),l.forEach(t=>{t.addEventListener("click",p=>{p.preventDefault();let i=t.getAttribute("data-category-name");l.forEach(g=>g.classList.remove("nav-item--selected","nav-item--view-all")),i==="VerTodo"?(y(),t.classList.add("nav-item--view-all")):L(i),t.classList.add("nav-item--selected"),s.scrollTo({left:t.offsetLeft-s.offsetLeft,behavior:"smooth"})})}),f.addEventListener("click",()=>{y(),l.forEach(t=>t.classList.remove("nav-item--selected","nav-item--view-all")),S.classList.add("nav-item--selected","nav-item--view-all"),s.scrollTo({left:S.offsetLeft-s.offsetLeft,behavior:"smooth"})})});var O=document.querySelector(".seo__toggle-btn"),w=document.getElementById("seoContent");O.addEventListener("click",()=>{let s=w.style.display==="none"||w.style.display==="";w.style.display=s?"block":"none",O.textContent=s?"Ver menos":"Ver m\xE1s"});var A=0,M;function b(){let s=document.querySelector(".main__container");if(s){let l=s.getBoundingClientRect().height;l>0&&l!==A&&(window.parent.postMessage(l,"*"),A=l)}}window.addEventListener("load",()=>{b()});document.addEventListener("navLoaded",()=>{b(),x()});function x(){let s=document.querySelector(".main__container"),l={attributes:!0,childList:!0,subtree:!0};s&&(M=new MutationObserver(b),M.observe(s,l))}setTimeout(()=>{b(),x()},4e3);})();
